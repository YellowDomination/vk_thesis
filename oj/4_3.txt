from saber.saber import Saber
from saber.config import Config


CONFIG = Config(filepath = "configs/myconf.ini")


saber = Saber(config = CONFIG)
saber.load_dataset('datasets/NCBI-disease-IOB')
saber.load_embeddings('word_embeddings/wikipedia-pubmed-and-PMC-w2v.bin')
saber.build(model_name='MT-LSTM-CRF')
saber.train()
saber.save('pretrained_models/exp3')

del saber
saber = Saber(config = CONFIG)
saber.load('pretrained_models/exp3')
saber.load_dataset('datasets/CADEC')
saber.load_embeddings('word_embeddings/wikipedia-pubmed-and-PMC-w2v.bin')
saber.build(model_name='MT-LSTM-CRF')
saber.train()
saber.save('pretrained_models/exp3/final')

### second fold exp2 variation
del saber

saber = Saber(config = CONFIG)
saber.load_dataset('datasets/NCBI-disease-IOB')
saber.load_embeddings('word_embeddings/Health_2.5mreviews.s200.w10.n5.v15.cbow.bin')
saber.build(model_name='MT-LSTM-CRF')
saber.train()
saber.save('pretrained_models/exp4')

del saber
saber = Saber(config = CONFIG)
saber.load('pretrained_models/exp4')
saber.load_dataset('datasets/CADEC/1')
saber.load_embeddings('word_embeddings/Health_2.5mreviews.s200.w10.n5.v15.cbow.bin')
saber.build(model_name='MT-LSTM-CRF')
saber.train()
saber.save('pretrained_models/exp4/final')

###
###
###

(saber) vk@vk-saber:~/pops/vk_thesis$ python start.py 
Using TensorFlow backend.
Saber version: 0.1.0-alpha
Loading (single) dataset... Done (2.95 seconds).
Loading embeddings... Done (89.33 seconds).
Loaded 10122/5443656 word vectors of dimension 200.
Building the multi-task BiLSTM-CRF model... Done (1.28 seconds).
Using train/test/valid strategy...
Global epoch: 1/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 1/10
4881/4881 [==============================] - 225s 46ms/step - loss: 7.0773 - val_loss: 6.6333
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    71.09% | 75.85% | 73.39% |    4633 |
| MACRO_AVG |    71.09% | 75.85% | 73.39% |    4633 |
| MICRO_AVG |    71.09% | 75.85% | 73.39% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    67.86% | 79.56% | 73.25% |     499 |
| MACRO_AVG |    67.86% | 79.56% | 73.25% |     499 |
| MICRO_AVG |    67.86% | 79.56% | 73.25% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    67.56% | 68.54% | 68.05% |     960 |
| MACRO_AVG |    67.56% | 68.54% | 68.05% |     960 |
| MICRO_AVG |    67.56% | 68.54% | 68.05% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 2/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 2/2
4881/4881 [==============================] - 223s 46ms/step - loss: 6.4264 - val_loss: 6.5845
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    88.59% | 72.03% | 79.45% |    4633 |
| MACRO_AVG |    88.59% | 72.03% | 79.45% |    4633 |
| MICRO_AVG |    88.59% | 72.03% | 79.45% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    86.92% | 74.55% | 80.26% |     499 |
| MACRO_AVG |    86.92% | 74.55% | 80.26% |     499 |
| MICRO_AVG |    86.92% | 74.55% | 80.26% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    83.64% | 62.29% | 71.40% |     960 |
| MACRO_AVG |    83.64% | 62.29% | 71.40% |     960 |
| MICRO_AVG |    83.64% | 62.29% | 71.40% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 3/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 3/3
4881/4881 [==============================] - 223s 46ms/step - loss: 6.3960 - val_loss: 6.5729
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    85.90% | 88.60% | 87.23% |    4633 |
| MACRO_AVG |    85.90% | 88.60% | 87.23% |    4633 |
| MICRO_AVG |    85.90% | 88.60% | 87.23% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    77.88% | 85.37% | 81.45% |     499 |
| MACRO_AVG |    77.88% | 85.37% | 81.45% |     499 |
| MICRO_AVG |    77.88% | 85.37% | 81.45% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    76.95% | 78.96% | 77.94% |     960 |
| MACRO_AVG |    76.95% | 78.96% | 77.94% |     960 |
| MICRO_AVG |    76.95% | 78.96% | 77.94% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 4/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 4/4
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3850 - val_loss: 6.5673
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    88.81% | 91.45% | 90.11% |    4633 |
| MACRO_AVG |    88.81% | 91.45% | 90.11% |    4633 |
| MICRO_AVG |    88.81% | 91.45% | 90.11% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.89% | 88.38% | 83.92% |     499 |
| MACRO_AVG |    79.89% | 88.38% | 83.92% |     499 |
| MICRO_AVG |    79.89% | 88.38% | 83.92% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.58% | 82.40% | 80.96% |     960 |
| MACRO_AVG |    79.58% | 82.40% | 80.96% |     960 |
| MICRO_AVG |    79.58% | 82.40% | 80.96% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 5/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 5/5
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3780 - val_loss: 6.5657
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    92.93% | 88.80% | 90.82% |    4633 |
| MACRO_AVG |    92.93% | 88.80% | 90.82% |    4633 |
| MICRO_AVG |    92.93% | 88.80% | 90.82% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    83.27% | 82.77% | 83.02% |     499 |
| MACRO_AVG |    83.27% | 82.77% | 83.02% |     499 |
| MICRO_AVG |    83.27% | 82.77% | 83.02% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    82.42% | 77.19% | 79.72% |     960 |
| MACRO_AVG |    82.42% | 77.19% | 79.72% |     960 |
| MICRO_AVG |    82.42% | 77.19% | 79.72% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 6/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 6/6
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3712 - val_loss: 6.5669
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    93.08% | 93.46% | 93.27% |    4633 |
| MACRO_AVG |    93.08% | 93.46% | 93.27% |    4633 |
| MICRO_AVG |    93.08% | 93.46% | 93.27% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    83.65% | 87.17% | 85.38% |     499 |
| MACRO_AVG |    83.65% | 87.17% | 85.38% |     499 |
| MICRO_AVG |    83.65% | 87.17% | 85.38% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.80% | 80.21% | 80.50% |     960 |
| MACRO_AVG |    80.80% | 80.21% | 80.50% |     960 |
| MICRO_AVG |    80.80% | 80.21% | 80.50% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 7/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 7/7
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3647 - val_loss: 6.5653
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    95.59% | 93.98% | 94.78% |    4633 |
| MACRO_AVG |    95.59% | 93.98% | 94.78% |    4633 |
| MICRO_AVG |    95.59% | 93.98% | 94.78% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.18% | 86.37% | 85.26% |     499 |
| MACRO_AVG |    84.18% | 86.37% | 85.26% |     499 |
| MICRO_AVG |    84.18% | 86.37% | 85.26% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.03% | 79.48% | 81.69% |     960 |
| MACRO_AVG |    84.03% | 79.48% | 81.69% |     960 |
| MICRO_AVG |    84.03% | 79.48% | 81.69% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 8/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 8/8
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3615 - val_loss: 6.5646
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    96.10% | 95.68% | 95.89% |    4633 |
| MACRO_AVG |    96.10% | 95.68% | 95.89% |    4633 |
| MICRO_AVG |    96.10% | 95.68% | 95.89% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.91% | 87.98% | 86.42% |     499 |
| MACRO_AVG |    84.91% | 87.98% | 86.42% |     499 |
| MICRO_AVG |    84.91% | 87.98% | 86.42% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.17% | 78.33% | 79.24% |     960 |
| MACRO_AVG |    80.17% | 78.33% | 79.24% |     960 |
| MICRO_AVG |    80.17% | 78.33% | 79.24% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 9/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 9/9
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3590 - val_loss: 6.5629
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    96.92% | 97.04% | 96.98% |    4633 |
| MACRO_AVG |    96.92% | 97.04% | 96.98% |    4633 |
| MICRO_AVG |    96.92% | 97.04% | 96.98% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.26% | 87.98% | 86.08% |     499 |
| MACRO_AVG |    84.26% | 87.98% | 86.08% |     499 |
| MICRO_AVG |    84.26% | 87.98% | 86.08% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.40% | 79.48% | 79.44% |     960 |
| MACRO_AVG |    79.40% | 79.48% | 79.44% |     960 |
| MICRO_AVG |    79.40% | 79.48% | 79.44% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 10/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 10/10
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3563 - val_loss: 6.5764
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    95.45% | 97.28% | 96.35% |    4633 |
| MACRO_AVG |    95.45% | 97.28% | 96.35% |    4633 |
| MICRO_AVG |    95.45% | 97.28% | 96.35% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.66% | 88.58% | 84.43% |     499 |
| MACRO_AVG |    80.66% | 88.58% | 84.43% |     499 |
| MICRO_AVG |    80.66% | 88.58% | 84.43% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    78.46% | 81.98% | 80.18% |     960 |
| MACRO_AVG |    78.46% | 81.98% | 80.18% |     960 |
| MICRO_AVG |    78.46% | 81.98% | 80.18% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 11/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 11/11
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3543 - val_loss: 6.5686
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.20% | 97.58% | 97.89% |    4633 |
| MACRO_AVG |    98.20% | 97.58% | 97.89% |    4633 |
| MICRO_AVG |    98.20% | 97.58% | 97.89% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    85.52% | 86.37% | 85.94% |     499 |
| MACRO_AVG |    85.52% | 86.37% | 85.94% |     499 |
| MICRO_AVG |    85.52% | 86.37% | 85.94% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    81.10% | 78.23% | 79.64% |     960 |
| MACRO_AVG |    81.10% | 78.23% | 79.64% |     960 |
| MICRO_AVG |    81.10% | 78.23% | 79.64% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 12/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 12/12
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3535 - val_loss: 6.5748
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.62% | 97.06% | 97.84% |    4633 |
| MACRO_AVG |    98.62% | 97.06% | 97.84% |    4633 |
| MICRO_AVG |    98.62% | 97.06% | 97.84% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    85.86% | 86.37% | 86.11% |     499 |
| MACRO_AVG |    85.86% | 86.37% | 86.11% |     499 |
| MICRO_AVG |    85.86% | 86.37% | 86.11% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    83.77% | 77.40% | 80.45% |     960 |
| MACRO_AVG |    83.77% | 77.40% | 80.45% |     960 |
| MICRO_AVG |    83.77% | 77.40% | 80.45% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 13/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 13/13
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3529 - val_loss: 6.5714
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.35% | 98.42% | 98.88% |    4633 |
| MACRO_AVG |    99.35% | 98.42% | 98.88% |    4633 |
| MICRO_AVG |    99.35% | 98.42% | 98.88% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    86.72% | 86.37% | 86.55% |     499 |
| MACRO_AVG |    86.72% | 86.37% | 86.55% |     499 |
| MICRO_AVG |    86.72% | 86.37% | 86.55% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.25% | 78.02% | 81.02% |     960 |
| MACRO_AVG |    84.25% | 78.02% | 81.02% |     960 |
| MICRO_AVG |    84.25% | 78.02% | 81.02% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 14/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 14/14
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3506 - val_loss: 6.5829
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    97.45% | 98.01% | 97.73% |    4633 |
| MACRO_AVG |    97.45% | 98.01% | 97.73% |    4633 |
| MICRO_AVG |    97.45% | 98.01% | 97.73% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    82.13% | 86.57% | 84.29% |     499 |
| MACRO_AVG |    82.13% | 86.57% | 84.29% |     499 |
| MICRO_AVG |    82.13% | 86.57% | 84.29% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    78.73% | 79.79% | 79.26% |     960 |
| MACRO_AVG |    78.73% | 79.79% | 79.26% |     960 |
| MICRO_AVG |    78.73% | 79.79% | 79.26% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 15/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 15/15
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3502 - val_loss: 6.5722
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.23% | 99.24% | 98.73% |    4633 |
| MACRO_AVG |    98.23% | 99.24% | 98.73% |    4633 |
| MICRO_AVG |    98.23% | 99.24% | 98.73% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    82.52% | 87.98% | 85.16% |     499 |
| MACRO_AVG |    82.52% | 87.98% | 85.16% |     499 |
| MICRO_AVG |    82.52% | 87.98% | 85.16% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    77.21% | 80.83% | 78.98% |     960 |
| MACRO_AVG |    77.21% | 80.83% | 78.98% |     960 |
| MICRO_AVG |    77.21% | 80.83% | 78.98% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 16/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 16/16
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3496 - val_loss: 6.5757
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.84% | 99.03% | 98.93% |    4633 |
| MACRO_AVG |    98.84% | 99.03% | 98.93% |    4633 |
| MICRO_AVG |    98.84% | 99.03% | 98.93% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.16% | 88.38% | 86.22% |     499 |
| MACRO_AVG |    84.16% | 88.38% | 86.22% |     499 |
| MICRO_AVG |    84.16% | 88.38% | 86.22% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.62% | 81.04% | 80.83% |     960 |
| MACRO_AVG |    80.62% | 81.04% | 80.83% |     960 |
| MICRO_AVG |    80.62% | 81.04% | 80.83% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 17/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 17/17
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3496 - val_loss: 6.5807
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.03% | 99.22% | 99.13% |    4633 |
| MACRO_AVG |    99.03% | 99.22% | 99.13% |    4633 |
| MICRO_AVG |    99.03% | 99.22% | 99.13% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    82.55% | 88.18% | 85.27% |     499 |
| MACRO_AVG |    82.55% | 88.18% | 85.27% |     499 |
| MICRO_AVG |    82.55% | 88.18% | 85.27% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.83% | 80.42% | 80.12% |     960 |
| MACRO_AVG |    79.83% | 80.42% | 80.12% |     960 |
| MICRO_AVG |    79.83% | 80.42% | 80.12% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 18/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 18/18
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3476 - val_loss: 6.5835
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.20% | 99.53% | 99.36% |    4633 |
| MACRO_AVG |    99.20% | 99.53% | 99.36% |    4633 |
| MICRO_AVG |    99.20% | 99.53% | 99.36% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    83.08% | 88.58% | 85.74% |     499 |
| MACRO_AVG |    83.08% | 88.58% | 85.74% |     499 |
| MICRO_AVG |    83.08% | 88.58% | 85.74% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    78.26% | 82.50% | 80.32% |     960 |
| MACRO_AVG |    78.26% | 82.50% | 80.32% |     960 |
| MICRO_AVG |    78.26% | 82.50% | 80.32% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 19/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 19/19
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3497 - val_loss: 6.5773
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.68% | 99.74% | 99.71% |    4633 |
| MACRO_AVG |    99.68% | 99.74% | 99.71% |    4633 |
| MICRO_AVG |    99.68% | 99.74% | 99.71% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.54% | 86.57% | 85.54% |     499 |
| MACRO_AVG |    84.54% | 86.57% | 85.54% |     499 |
| MICRO_AVG |    84.54% | 86.57% | 85.54% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    78.89% | 79.79% | 79.34% |     960 |
| MACRO_AVG |    78.89% | 79.79% | 79.34% |     960 |
| MICRO_AVG |    78.89% | 79.79% | 79.34% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 20/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 20/20
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3478 - val_loss: 6.5832
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.91% | 99.74% | 99.83% |    4633 |
| MACRO_AVG |    99.91% | 99.74% | 99.83% |    4633 |
| MICRO_AVG |    99.91% | 99.74% | 99.83% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    83.86% | 85.37% | 84.61% |     499 |
| MACRO_AVG |    83.86% | 85.37% | 84.61% |     499 |
| MICRO_AVG |    83.86% | 85.37% | 84.61% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.88% | 80.21% | 80.54% |     960 |
| MACRO_AVG |    80.88% | 80.21% | 80.54% |     960 |
| MICRO_AVG |    80.88% | 80.21% | 80.54% |     960 |
+-----------+-----------+--------+--------+---------+
Saving model... Done (0.90 seconds).
Model was saved to /home/vk/pops/vk_thesis/pretrained_models/exp3
Loading model... Unzipping... Done (2.10 seconds).
Loading (single) dataset... 
Transferring from pre-trained model... Done (1.92 seconds).
Loading embeddings... Done (87.30 seconds).
Loaded 10122/5443656 word vectors of dimension 200.
Building the multi-task BiLSTM-CRF model... Done (2.53 seconds).
Using train/test/valid strategy...
Global epoch: 1/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 1/1
2385/2385 [==============================] - 105s 44ms/step - loss: 14.4206 - val_loss: 13.5297
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    51.33% | 10.18% | 17.00% |    2661 |
| MED       |     0.00% |  0.00% |  0.00% |     565 |
| MACRO_AVG |    25.66% |  5.09% |  8.50% |    3226 |
| MICRO_AVG |    51.33% |  8.40% | 14.44% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    46.81% |  8.15% | 13.88% |     270 |
| MED       |     0.00% |  0.00% |  0.00% |      85 |
| MACRO_AVG |    23.40% |  4.07% |  6.94% |     355 |
| MICRO_AVG |    46.81% |  6.20% | 10.95% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    47.89% |  9.34% | 15.63% |     728 |
| MED       |     0.00% |  0.00% |  0.00% |     155 |
| MACRO_AVG |    23.94% |  4.67% |  7.82% |     883 |
| MICRO_AVG |    47.89% |  7.70% | 13.27% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 2/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 2/2
2385/2385 [==============================] - 102s 43ms/step - loss: 14.1991 - val_loss: 13.4379
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    57.90% | 30.85% | 40.25% |    2661 |
| MED       |     0.00% |  0.00% |  0.00% |     565 |
| MACRO_AVG |    28.95% | 15.43% | 20.13% |    3226 |
| MICRO_AVG |    57.90% | 25.45% | 35.36% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    48.18% | 24.44% | 32.43% |     270 |
| MED       |     0.00% |  0.00% |  0.00% |      85 |
| MACRO_AVG |    24.09% | 12.22% | 16.22% |     355 |
| MICRO_AVG |    48.18% | 18.59% | 26.83% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    57.11% | 29.81% | 39.17% |     728 |
| MED       |     0.00% |  0.00% |  0.00% |     155 |
| MACRO_AVG |    28.55% | 14.90% | 19.58% |     883 |
| MICRO_AVG |    57.11% | 24.58% | 34.36% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 3/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 3/3
2385/2385 [==============================] - 102s 43ms/step - loss: 14.1252 - val_loss: 13.3726
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.15% | 39.83% | 47.28% |    2661 |
| MED       |    62.50% |  4.42% |  8.26% |     565 |
| MACRO_AVG |    60.32% | 22.13% | 27.77% |    3226 |
| MICRO_AVG |    58.24% | 33.63% | 42.64% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    52.72% | 35.93% | 42.73% |     270 |
| MED       |     0.00% |  0.00% |  0.00% |      85 |
| MACRO_AVG |    26.36% | 17.96% | 21.37% |     355 |
| MICRO_AVG |    52.43% | 27.32% | 35.93% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.96% | 37.09% | 44.93% |     728 |
| MED       |    71.43% |  3.23% |  6.17% |     155 |
| MACRO_AVG |    64.20% | 20.16% | 25.55% |     883 |
| MICRO_AVG |    57.17% | 31.14% | 40.32% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 4/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 4/4
2385/2385 [==============================] - 102s 43ms/step - loss: 14.0721 - val_loss: 13.3503
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    60.92% | 46.97% | 53.04% |    2661 |
| MED       |    83.79% | 37.52% | 51.83% |     565 |
| MACRO_AVG |    72.36% | 42.25% | 52.44% |    3226 |
| MICRO_AVG |    63.43% | 45.32% | 52.87% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    50.25% | 37.78% | 43.13% |     270 |
| MED       |    93.18% | 48.24% | 63.57% |      85 |
| MACRO_AVG |    71.71% | 43.01% | 53.35% |     355 |
| MICRO_AVG |    57.89% | 40.28% | 47.51% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.12% | 39.70% | 46.50% |     728 |
| MED       |    72.97% | 34.84% | 47.16% |     155 |
| MACRO_AVG |    64.54% | 37.27% | 46.83% |     883 |
| MICRO_AVG |    58.23% | 38.84% | 46.60% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 5/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 5/5
2385/2385 [==============================] - 102s 43ms/step - loss: 14.0341 - val_loss: 13.3073
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    68.00% | 55.73% | 61.26% |    2661 |
| MED       |    66.21% | 68.32% | 67.25% |     565 |
| MACRO_AVG |    67.10% | 62.02% | 64.25% |    3226 |
| MICRO_AVG |    67.62% | 57.94% | 62.40% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.58% | 47.78% | 51.81% |     270 |
| MED       |    63.04% | 68.24% | 65.54% |      85 |
| MACRO_AVG |    59.81% | 58.01% | 58.67% |     355 |
| MICRO_AVG |    58.44% | 52.68% | 55.41% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    62.17% | 48.08% | 54.22% |     728 |
| MED       |    63.98% | 66.45% | 65.19% |     155 |
| MACRO_AVG |    63.07% | 57.26% | 59.71% |     883 |
| MICRO_AVG |    62.57% | 51.30% | 56.38% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 6/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 6/6
2385/2385 [==============================] - 102s 43ms/step - loss: 14.0014 - val_loss: 13.2952
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    66.79% | 63.02% | 64.85% |    2661 |
| MED       |    86.34% | 55.93% | 67.88% |     565 |
| MACRO_AVG |    76.56% | 59.48% | 66.37% |    3226 |
| MICRO_AVG |    69.27% | 61.78% | 65.31% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    53.41% | 55.19% | 54.28% |     270 |
| MED       |    89.29% | 58.82% | 70.92% |      85 |
| MACRO_AVG |    71.35% | 57.00% | 62.60% |     355 |
| MICRO_AVG |    59.40% | 56.06% | 57.68% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.31% | 50.14% | 53.91% |     728 |
| MED       |    77.45% | 50.97% | 61.48% |     155 |
| MACRO_AVG |    67.88% | 50.55% | 57.70% |     883 |
| MICRO_AVG |    60.99% | 50.28% | 55.12% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 7/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 7/7
2385/2385 [==============================] - 102s 43ms/step - loss: 13.9768 - val_loss: 13.2811
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    73.72% | 63.66% | 68.32% |    2661 |
| MED       |    82.19% | 71.86% | 76.68% |     565 |
| MACRO_AVG |    77.95% | 67.76% | 72.50% |    3226 |
| MICRO_AVG |    75.21% | 65.10% | 69.79% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.45% | 51.85% | 54.05% |     270 |
| MED       |    72.73% | 65.88% | 69.14% |      85 |
| MACRO_AVG |    64.59% | 58.87% | 61.59% |     355 |
| MICRO_AVG |    60.31% | 55.21% | 57.65% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    62.68% | 48.90% | 54.94% |     728 |
| MED       |    76.56% | 63.23% | 69.26% |     155 |
| MACRO_AVG |    69.62% | 56.06% | 62.10% |     883 |
| MICRO_AVG |    65.23% | 51.42% | 57.50% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 8/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 8/8
2385/2385 [==============================] - 102s 43ms/step - loss: 13.9565 - val_loss: 13.2838
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    67.25% | 69.67% | 68.44% |    2661 |
| MED       |    88.57% | 71.33% | 79.02% |     565 |
| MACRO_AVG |    77.91% | 70.50% | 73.73% |    3226 |
| MICRO_AVG |    70.27% | 69.96% | 70.11% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    51.29% | 58.89% | 54.83% |     270 |
| MED       |    79.17% | 67.06% | 72.61% |      85 |
| MACRO_AVG |    65.23% | 62.97% | 63.72% |     355 |
| MICRO_AVG |    56.54% | 60.85% | 58.62% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    55.23% | 54.40% | 54.81% |     728 |
| MED       |    82.79% | 65.16% | 72.92% |     155 |
| MACRO_AVG |    69.01% | 59.78% | 63.87% |     883 |
| MICRO_AVG |    59.24% | 56.29% | 57.72% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 9/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 9/9
2385/2385 [==============================] - 102s 43ms/step - loss: 13.9397 - val_loss: 13.2867
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    78.93% | 67.16% | 72.57% |    2661 |
| MED       |    74.03% | 84.78% | 79.04% |     565 |
| MACRO_AVG |    76.48% | 75.97% | 75.81% |    3226 |
| MICRO_AVG |    77.84% | 70.24% | 73.85% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    62.17% | 52.96% | 57.20% |     270 |
| MED       |    60.58% | 74.12% | 66.67% |      85 |
| MACRO_AVG |    61.38% | 63.54% | 61.93% |     355 |
| MICRO_AVG |    61.68% | 58.03% | 59.80% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    65.69% | 49.45% | 56.43% |     728 |
| MED       |    62.78% | 72.90% | 67.46% |     155 |
| MACRO_AVG |    64.24% | 61.18% | 61.94% |     883 |
| MICRO_AVG |    64.97% | 53.57% | 58.72% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 10/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 10/10
2385/2385 [==============================] - 102s 43ms/step - loss: 13.9219 - val_loss: 13.2850
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    79.48% | 74.11% | 76.70% |    2661 |
| MED       |    58.46% | 89.91% | 70.85% |     565 |
| MACRO_AVG |    68.97% | 82.01% | 73.78% |    3226 |
| MICRO_AVG |    74.03% | 76.88% | 75.43% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.59% | 55.56% | 57.03% |     270 |
| MED       |    51.08% | 83.53% | 63.39% |      85 |
| MACRO_AVG |    54.84% | 69.54% | 60.21% |     355 |
| MICRO_AVG |    55.95% | 62.25% | 58.93% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    60.79% | 50.69% | 55.28% |     728 |
| MED       |    45.45% | 80.65% | 58.14% |     155 |
| MACRO_AVG |    53.12% | 65.67% | 56.71% |     883 |
| MICRO_AVG |    56.01% | 55.95% | 55.98% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 11/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 11/11
2385/2385 [==============================] - 102s 43ms/step - loss: 13.9028 - val_loss: 13.2946
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    71.52% | 76.06% | 73.72% |    2661 |
| MED       |    90.98% | 83.89% | 87.29% |     565 |
| MACRO_AVG |    81.25% | 79.98% | 80.51% |    3226 |
| MICRO_AVG |    74.54% | 77.43% | 75.96% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    48.90% | 57.41% | 52.81% |     270 |
| MED       |    78.21% | 71.76% | 74.85% |      85 |
| MACRO_AVG |    63.55% | 64.59% | 63.83% |     355 |
| MICRO_AVG |    54.68% | 60.85% | 57.60% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    51.26% | 53.16% | 52.19% |     728 |
| MED       |    76.71% | 72.26% | 74.42% |     155 |
| MACRO_AVG |    63.99% | 62.71% | 63.31% |     883 |
| MICRO_AVG |    55.38% | 56.51% | 55.94% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 12/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 12/12
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8897 - val_loss: 13.3188
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    89.40% | 70.69% | 78.95% |    2661 |
| MED       |    94.91% | 75.93% | 84.37% |     565 |
| MACRO_AVG |    92.16% | 73.31% | 81.66% |    3226 |
| MICRO_AVG |    90.38% | 71.61% | 79.90% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    61.62% | 45.19% | 52.14% |     270 |
| MED       |    80.82% | 69.41% | 74.68% |      85 |
| MACRO_AVG |    71.22% | 57.30% | 63.41% |     355 |
| MICRO_AVG |    66.79% | 50.99% | 57.83% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    70.82% | 46.02% | 55.79% |     728 |
| MED       |    83.04% | 60.00% | 69.66% |     155 |
| MACRO_AVG |    76.93% | 53.01% | 62.72% |     883 |
| MICRO_AVG |    73.16% | 48.47% | 58.31% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 13/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 13/13
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8792 - val_loss: 13.3084
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    89.39% | 79.74% | 84.29% |    2661 |
| MED       |    90.78% | 90.62% | 90.70% |     565 |
| MACRO_AVG |    90.08% | 85.18% | 87.49% |    3226 |
| MICRO_AVG |    89.65% | 81.65% | 85.46% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    62.27% | 50.74% | 55.92% |     270 |
| MED       |    72.09% | 72.94% | 72.51% |      85 |
| MACRO_AVG |    67.18% | 61.84% | 64.22% |     355 |
| MICRO_AVG |    65.03% | 56.06% | 60.21% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    67.69% | 51.51% | 58.50% |     728 |
| MED       |    74.68% | 74.19% | 74.43% |     155 |
| MACRO_AVG |    71.18% | 62.85% | 66.47% |     883 |
| MICRO_AVG |    69.21% | 55.49% | 61.60% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 14/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 14/14
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8694 - val_loss: 13.2992
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    91.84% | 85.04% | 88.31% |    2661 |
| MED       |    94.92% | 89.20% | 91.97% |     565 |
| MACRO_AVG |    93.38% | 87.12% | 90.14% |    3226 |
| MICRO_AVG |    92.39% | 85.77% | 88.96% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.57% | 54.44% | 56.43% |     270 |
| MED       |    80.52% | 72.94% | 76.54% |      85 |
| MACRO_AVG |    69.54% | 63.69% | 66.49% |     355 |
| MICRO_AVG |    63.72% | 58.87% | 61.20% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    65.16% | 51.65% | 57.62% |     728 |
| MED       |    79.43% | 72.26% | 75.68% |     155 |
| MACRO_AVG |    72.30% | 61.95% | 66.65% |     883 |
| MICRO_AVG |    67.97% | 55.27% | 60.96% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 15/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 15/15
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8564 - val_loss: 13.3499
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    93.42% | 83.20% | 88.01% |    2661 |
| MED       |    96.47% | 87.08% | 91.53% |     565 |
| MACRO_AVG |    94.94% | 85.14% | 89.77% |    3226 |
| MICRO_AVG |    93.96% | 83.88% | 88.63% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.15% | 48.89% | 53.12% |     270 |
| MED       |    86.76% | 69.41% | 77.12% |      85 |
| MACRO_AVG |    72.46% | 59.15% | 65.12% |     355 |
| MICRO_AVG |    64.75% | 53.80% | 58.77% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    66.60% | 49.31% | 56.67% |     728 |
| MED       |    79.84% | 66.45% | 72.54% |     155 |
| MACRO_AVG |    73.22% | 57.88% | 64.60% |     883 |
| MICRO_AVG |    69.16% | 52.32% | 59.57% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 16/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 16/16
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8498 - val_loss: 13.3297
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    93.36% | 89.89% | 91.59% |    2661 |
| MED       |    95.05% | 95.22% | 95.14% |     565 |
| MACRO_AVG |    94.21% | 92.56% | 93.37% |    3226 |
| MICRO_AVG |    93.67% | 90.82% | 92.23% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    55.65% | 51.11% | 53.28% |     270 |
| MED       |    73.33% | 77.65% | 75.43% |      85 |
| MACRO_AVG |    64.49% | 64.38% | 64.36% |     355 |
| MICRO_AVG |    60.36% | 57.46% | 58.87% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    60.65% | 51.24% | 55.55% |     728 |
| MED       |    70.62% | 72.90% | 71.75% |     155 |
| MACRO_AVG |    65.64% | 62.07% | 63.65% |     883 |
| MICRO_AVG |    62.71% | 55.04% | 58.62% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 17/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 17/17
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8411 - val_loss: 13.3612
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    89.55% | 92.15% | 90.83% |    2661 |
| MED       |    87.79% | 95.40% | 91.43% |     565 |
| MACRO_AVG |    88.67% | 93.77% | 91.13% |    3226 |
| MICRO_AVG |    89.23% | 92.72% | 90.94% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    50.48% | 58.15% | 54.04% |     270 |
| MED       |    65.09% | 81.18% | 72.25% |      85 |
| MACRO_AVG |    57.79% | 69.66% | 63.15% |     355 |
| MICRO_AVG |    54.20% | 63.66% | 58.55% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    55.13% | 56.87% | 55.98% |     728 |
| MED       |    66.48% | 76.77% | 71.26% |     155 |
| MACRO_AVG |    60.80% | 66.82% | 63.62% |     883 |
| MICRO_AVG |    57.31% | 60.36% | 58.80% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 18/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 18/18
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8382 - val_loss: 13.3422
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    95.44% | 95.11% | 95.28% |    2661 |
| MED       |    94.61% | 96.28% | 95.44% |     565 |
| MACRO_AVG |    95.02% | 95.70% | 95.36% |    3226 |
| MICRO_AVG |    95.29% | 95.32% | 95.30% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.20% | 57.04% | 56.62% |     270 |
| MED       |    75.86% | 77.65% | 76.74% |      85 |
| MACRO_AVG |    66.03% | 67.34% | 66.68% |     355 |
| MICRO_AVG |    60.94% | 61.97% | 61.45% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    59.91% | 56.46% | 58.13% |     728 |
| MED       |    73.86% | 72.90% | 73.38% |     155 |
| MACRO_AVG |    66.88% | 64.68% | 65.75% |     883 |
| MICRO_AVG |    62.46% | 59.34% | 60.86% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 19/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 19/19
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8334 - val_loss: 13.3723
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    96.52% | 94.74% | 95.62% |    2661 |
| MED       |    98.16% | 94.34% | 96.21% |     565 |
| MACRO_AVG |    97.34% | 94.54% | 95.91% |    3226 |
| MICRO_AVG |    96.80% | 94.67% | 95.72% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    53.82% | 54.81% | 54.31% |     270 |
| MED       |    82.86% | 68.24% | 74.84% |      85 |
| MACRO_AVG |    68.34% | 61.53% | 64.58% |     355 |
| MICRO_AVG |    59.71% | 58.03% | 58.86% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    61.35% | 54.95% | 57.97% |     728 |
| MED       |    84.43% | 66.45% | 74.37% |     155 |
| MACRO_AVG |    72.89% | 60.70% | 66.17% |     883 |
| MICRO_AVG |    64.99% | 56.96% | 60.71% |     883 |
+-----------+-----------+--------+--------+---------+
Global epoch: 20/20
--------------------
Train on 2385 samples, validate on 265 samples
Epoch 20/20
2385/2385 [==============================] - 102s 43ms/step - loss: 13.8313 - val_loss: 13.4233
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    87.84% | 92.03% | 89.89% |    2661 |
| MED       |    99.02% | 89.56% | 94.05% |     565 |
| MACRO_AVG |    93.43% | 90.80% | 91.97% |    3226 |
| MICRO_AVG |    89.57% | 91.60% | 90.57% |    3226 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    46.05% | 51.85% | 48.78% |     270 |
| MED       |    86.11% | 72.94% | 78.98% |      85 |
| MACRO_AVG |    66.08% | 62.40% | 63.88% |     355 |
| MICRO_AVG |    53.72% | 56.90% | 55.27% |     355 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    55.37% | 54.53% | 54.95% |     728 |
| MED       |    85.71% | 65.81% | 74.45% |     155 |
| MACRO_AVG |    70.54% | 60.17% | 64.70% |     883 |
| MICRO_AVG |    59.69% | 56.51% | 58.06% |     883 |
+-----------+-----------+--------+--------+---------+
Saving model... Done (0.89 seconds).
Model was saved to /home/vk/pops/vk_thesis/pretrained_models/exp3/final
Loading (single) dataset... Done (2.97 seconds).
Loading embeddings... Done (1.09 seconds).
Loaded 10122/73644 word vectors of dimension 200.
Building the multi-task BiLSTM-CRF model... Done (3.35 seconds).
Using train/test/valid strategy...
Global epoch: 1/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 1/1
4881/4881 [==============================] - 212s 44ms/step - loss: 6.5891 - val_loss: 6.6384
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    78.47% | 58.77% | 67.21% |    4633 |
| MACRO_AVG |    78.47% | 58.77% | 67.21% |    4633 |
| MICRO_AVG |    78.47% | 58.77% | 67.21% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    75.96% | 55.71% | 64.28% |     499 |
| MACRO_AVG |    75.96% | 55.71% | 64.28% |     499 |
| MICRO_AVG |    75.96% | 55.71% | 64.28% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    73.80% | 51.35% | 60.57% |     960 |
| MACRO_AVG |    73.80% | 51.35% | 60.57% |     960 |
| MICRO_AVG |    73.80% | 51.35% | 60.57% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 2/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 2/2
4881/4881 [==============================] - 209s 43ms/step - loss: 6.4382 - val_loss: 6.6212
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    76.79% | 80.77% | 78.73% |    4633 |
| MACRO_AVG |    76.79% | 80.77% | 78.73% |    4633 |
| MICRO_AVG |    76.79% | 80.77% | 78.73% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    67.26% | 76.15% | 71.43% |     499 |
| MACRO_AVG |    67.26% | 76.15% | 71.43% |     499 |
| MICRO_AVG |    67.26% | 76.15% | 71.43% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    66.98% | 67.40% | 67.19% |     960 |
| MACRO_AVG |    66.98% | 67.40% | 67.19% |     960 |
| MICRO_AVG |    66.98% | 67.40% | 67.19% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 3/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 3/3
4881/4881 [==============================] - 209s 43ms/step - loss: 6.4089 - val_loss: 6.6017
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    87.55% | 81.85% | 84.61% |    4633 |
| MACRO_AVG |    87.55% | 81.85% | 84.61% |    4633 |
| MICRO_AVG |    87.55% | 81.85% | 84.61% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.59% | 76.55% | 78.52% |     499 |
| MACRO_AVG |    80.59% | 76.55% | 78.52% |     499 |
| MICRO_AVG |    80.59% | 76.55% | 78.52% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    76.96% | 66.46% | 71.32% |     960 |
| MACRO_AVG |    76.96% | 66.46% | 71.32% |     960 |
| MICRO_AVG |    76.96% | 66.46% | 71.32% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 4/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 4/4
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3921 - val_loss: 6.5927
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    92.14% | 86.34% | 89.15% |    4633 |
| MACRO_AVG |    92.14% | 86.34% | 89.15% |    4633 |
| MICRO_AVG |    92.14% | 86.34% | 89.15% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    82.47% | 76.35% | 79.29% |     499 |
| MACRO_AVG |    82.47% | 76.35% | 79.29% |     499 |
| MICRO_AVG |    82.47% | 76.35% | 79.29% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    78.75% | 69.48% | 73.82% |     960 |
| MACRO_AVG |    78.75% | 69.48% | 73.82% |     960 |
| MICRO_AVG |    78.75% | 69.48% | 73.82% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 5/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 5/5
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3808 - val_loss: 6.5968
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    90.54% | 93.61% | 92.05% |    4633 |
| MACRO_AVG |    90.54% | 93.61% | 92.05% |    4633 |
| MICRO_AVG |    90.54% | 93.61% | 92.05% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    76.07% | 81.56% | 78.72% |     499 |
| MACRO_AVG |    76.07% | 81.56% | 78.72% |     499 |
| MICRO_AVG |    76.07% | 81.56% | 78.72% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    74.24% | 76.56% | 75.38% |     960 |
| MACRO_AVG |    74.24% | 76.56% | 75.38% |     960 |
| MICRO_AVG |    74.24% | 76.56% | 75.38% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 6/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 6/6
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3719 - val_loss: 6.6065
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    94.88% | 93.96% | 94.41% |    4633 |
| MACRO_AVG |    94.88% | 93.96% | 94.41% |    4633 |
| MICRO_AVG |    94.88% | 93.96% | 94.41% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    81.74% | 78.96% | 80.33% |     499 |
| MACRO_AVG |    81.74% | 78.96% | 80.33% |     499 |
| MICRO_AVG |    81.74% | 78.96% | 80.33% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    78.62% | 74.69% | 76.60% |     960 |
| MACRO_AVG |    78.62% | 74.69% | 76.60% |     960 |
| MICRO_AVG |    78.62% | 74.69% | 76.60% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 7/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 7/7
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3670 - val_loss: 6.6034
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    95.74% | 94.13% | 94.93% |    4633 |
| MACRO_AVG |    95.74% | 94.13% | 94.93% |    4633 |
| MICRO_AVG |    95.74% | 94.13% | 94.93% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    81.82% | 79.36% | 80.57% |     499 |
| MACRO_AVG |    81.82% | 79.36% | 80.57% |     499 |
| MICRO_AVG |    81.82% | 79.36% | 80.57% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.63% | 72.50% | 75.90% |     960 |
| MACRO_AVG |    79.63% | 72.50% | 75.90% |     960 |
| MICRO_AVG |    79.63% | 72.50% | 75.90% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 8/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 8/8
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3620 - val_loss: 6.6018
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    95.47% | 97.37% | 96.41% |    4633 |
| MACRO_AVG |    95.47% | 97.37% | 96.41% |    4633 |
| MICRO_AVG |    95.47% | 97.37% | 96.41% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    75.18% | 81.96% | 78.43% |     499 |
| MACRO_AVG |    75.18% | 81.96% | 78.43% |     499 |
| MICRO_AVG |    75.18% | 81.96% | 78.43% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    74.52% | 76.46% | 75.48% |     960 |
| MACRO_AVG |    74.52% | 76.46% | 75.48% |     960 |
| MICRO_AVG |    74.52% | 76.46% | 75.48% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 9/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 9/9
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3601 - val_loss: 6.6183
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    97.67% | 94.93% | 96.28% |    4633 |
| MACRO_AVG |    97.67% | 94.93% | 96.28% |    4633 |
| MICRO_AVG |    97.67% | 94.93% | 96.28% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.96% | 75.95% | 77.90% |     499 |
| MACRO_AVG |    79.96% | 75.95% | 77.90% |     499 |
| MICRO_AVG |    79.96% | 75.95% | 77.90% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.07% | 68.65% | 73.92% |     960 |
| MACRO_AVG |    80.07% | 68.65% | 73.92% |     960 |
| MICRO_AVG |    80.07% | 68.65% | 73.92% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 10/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 10/10
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3593 - val_loss: 6.6147
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    96.80% | 96.11% | 96.46% |    4633 |
| MACRO_AVG |    96.80% | 96.11% | 96.46% |    4633 |
| MICRO_AVG |    96.80% | 96.11% | 96.46% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.80% | 80.76% | 80.28% |     499 |
| MACRO_AVG |    79.80% | 80.76% | 80.28% |     499 |
| MICRO_AVG |    79.80% | 80.76% | 80.28% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    77.66% | 71.35% | 74.38% |     960 |
| MACRO_AVG |    77.66% | 71.35% | 74.38% |     960 |
| MICRO_AVG |    77.66% | 71.35% | 74.38% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 11/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 11/11
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3559 - val_loss: 6.5963
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    96.59% | 98.29% | 97.43% |    4633 |
| MACRO_AVG |    96.59% | 98.29% | 97.43% |    4633 |
| MICRO_AVG |    96.59% | 98.29% | 97.43% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    77.96% | 84.37% | 81.04% |     499 |
| MACRO_AVG |    77.96% | 84.37% | 81.04% |     499 |
| MICRO_AVG |    77.96% | 84.37% | 81.04% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    73.23% | 76.67% | 74.91% |     960 |
| MACRO_AVG |    73.23% | 76.67% | 74.91% |     960 |
| MICRO_AVG |    73.23% | 76.67% | 74.91% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 12/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 12/12
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3540 - val_loss: 6.5987
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.51% | 98.38% | 98.44% |    4633 |
| MACRO_AVG |    98.51% | 98.38% | 98.44% |    4633 |
| MICRO_AVG |    98.51% | 98.38% | 98.44% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.28% | 81.56% | 80.91% |     499 |
| MACRO_AVG |    80.28% | 81.56% | 80.91% |     499 |
| MICRO_AVG |    80.28% | 81.56% | 80.91% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    76.57% | 73.54% | 75.03% |     960 |
| MACRO_AVG |    76.57% | 73.54% | 75.03% |     960 |
| MICRO_AVG |    76.57% | 73.54% | 75.03% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 13/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 13/13
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3523 - val_loss: 6.6016
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.03% | 98.75% | 98.89% |    4633 |
| MACRO_AVG |    99.03% | 98.75% | 98.89% |    4633 |
| MICRO_AVG |    99.03% | 98.75% | 98.89% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    82.90% | 82.57% | 82.73% |     499 |
| MACRO_AVG |    82.90% | 82.57% | 82.73% |     499 |
| MICRO_AVG |    82.90% | 82.57% | 82.73% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    77.55% | 75.21% | 76.36% |     960 |
| MACRO_AVG |    77.55% | 75.21% | 76.36% |     960 |
| MICRO_AVG |    77.55% | 75.21% | 76.36% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 14/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 14/14
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3522 - val_loss: 6.6033
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.41% | 99.16% | 98.79% |    4633 |
| MACRO_AVG |    98.41% | 99.16% | 98.79% |    4633 |
| MICRO_AVG |    98.41% | 99.16% | 98.79% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.97% | 83.57% | 82.25% |     499 |
| MACRO_AVG |    80.97% | 83.57% | 82.25% |     499 |
| MICRO_AVG |    80.97% | 83.57% | 82.25% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    75.84% | 77.81% | 76.81% |     960 |
| MACRO_AVG |    75.84% | 77.81% | 76.81% |     960 |
| MICRO_AVG |    75.84% | 77.81% | 76.81% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 15/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 15/15
4881/4881 [==============================] - 208s 43ms/step - loss: 6.3514 - val_loss: 6.6134
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.07% | 98.79% | 98.93% |    4633 |
| MACRO_AVG |    99.07% | 98.79% | 98.93% |    4633 |
| MICRO_AVG |    99.07% | 98.79% | 98.93% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    81.86% | 79.56% | 80.69% |     499 |
| MACRO_AVG |    81.86% | 79.56% | 80.69% |     499 |
| MICRO_AVG |    81.86% | 79.56% | 80.69% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    77.58% | 74.27% | 75.89% |     960 |
| MACRO_AVG |    77.58% | 74.27% | 75.89% |     960 |
| MICRO_AVG |    77.58% | 74.27% | 75.89% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 16/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 16/16
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3518 - val_loss: 6.6516
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    89.06% | 98.25% | 93.43% |    4633 |
| MACRO_AVG |    89.06% | 98.25% | 93.43% |    4633 |
| MICRO_AVG |    89.06% | 98.25% | 93.43% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    65.84% | 84.97% | 74.19% |     499 |
| MACRO_AVG |    65.84% | 84.97% | 74.19% |     499 |
| MICRO_AVG |    65.84% | 84.97% | 74.19% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    65.56% | 80.31% | 72.19% |     960 |
| MACRO_AVG |    65.56% | 80.31% | 72.19% |     960 |
| MICRO_AVG |    65.56% | 80.31% | 72.19% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 17/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 17/17
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3538 - val_loss: 6.6119
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.01% | 98.99% | 98.50% |    4633 |
| MACRO_AVG |    98.01% | 98.99% | 98.50% |    4633 |
| MICRO_AVG |    98.01% | 98.99% | 98.50% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.18% | 81.56% | 80.36% |     499 |
| MACRO_AVG |    79.18% | 81.56% | 80.36% |     499 |
| MICRO_AVG |    79.18% | 81.56% | 80.36% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    76.64% | 76.88% | 76.76% |     960 |
| MACRO_AVG |    76.64% | 76.88% | 76.76% |     960 |
| MICRO_AVG |    76.64% | 76.88% | 76.76% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 18/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 18/18
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3519 - val_loss: 6.6301
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.33% | 98.47% | 98.89% |    4633 |
| MACRO_AVG |    99.33% | 98.47% | 98.89% |    4633 |
| MICRO_AVG |    99.33% | 98.47% | 98.89% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    83.44% | 78.76% | 81.03% |     499 |
| MACRO_AVG |    83.44% | 78.76% | 81.03% |     499 |
| MICRO_AVG |    83.44% | 78.76% | 81.03% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.05% | 71.46% | 75.51% |     960 |
| MACRO_AVG |    80.05% | 71.46% | 75.51% |     960 |
| MICRO_AVG |    80.05% | 71.46% | 75.51% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 19/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 19/19
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3511 - val_loss: 6.6062
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    98.71% | 99.12% | 98.91% |    4633 |
| MACRO_AVG |    98.71% | 99.12% | 98.91% |    4633 |
| MICRO_AVG |    98.71% | 99.12% | 98.91% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    80.53% | 85.37% | 82.88% |     499 |
| MACRO_AVG |    80.53% | 85.37% | 82.88% |     499 |
| MICRO_AVG |    80.53% | 85.37% | 82.88% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    75.73% | 75.73% | 75.73% |     960 |
| MACRO_AVG |    75.73% | 75.73% | 75.73% |     960 |
| MICRO_AVG |    75.73% | 75.73% | 75.73% |     960 |
+-----------+-----------+--------+--------+---------+
Global epoch: 20/20
--------------------
Train on 4881 samples, validate on 543 samples
Epoch 20/20
4881/4881 [==============================] - 209s 43ms/step - loss: 6.3495 - val_loss: 6.6078
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    99.55% | 99.29% | 99.42% |    4633 |
| MACRO_AVG |    99.55% | 99.29% | 99.42% |    4633 |
| MICRO_AVG |    99.55% | 99.29% | 99.42% |    4633 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    84.89% | 82.16% | 83.50% |     499 |
| MACRO_AVG |    84.89% | 82.16% | 83.50% |     499 |
| MICRO_AVG |    84.89% | 82.16% | 83.50% |     499 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| Disease   |    79.57% | 73.85% | 76.61% |     960 |
| MACRO_AVG |    79.57% | 73.85% | 76.61% |     960 |
| MICRO_AVG |    79.57% | 73.85% | 76.61% |     960 |
+-----------+-----------+--------+--------+---------+
Saving model... Done (0.59 seconds).
Model was saved to /home/vk/pops/vk_thesis/pretrained_models/exp4
Loading model... Unzipping... Done (3.07 seconds).
Loading (single) dataset... 
Transferring from pre-trained model... Done (3.01 seconds).
Loading embeddings... Done (1.09 seconds).
Loaded 10122/73644 word vectors of dimension 200.
Building the multi-task BiLSTM-CRF model... Done (4.76 seconds).
Using train/test/valid strategy...
Global epoch: 1/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 1/1
2375/2375 [==============================] - 106s 45ms/step - loss: 14.8889 - val_loss: 13.5611
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    32.96% | 10.16% | 15.53% |    2619 |
| MED       |    85.71% |  1.10% |  2.18% |     543 |
| MACRO_AVG |    59.34% |  5.63% |  8.86% |    3162 |
| MICRO_AVG |    33.42% |  8.60% | 13.68% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    29.11% |  8.52% | 13.18% |     270 |
| MED       |     0.00% |  0.00% |  0.00% |      84 |
| MACRO_AVG |    14.56% |  4.26% |  6.59% |     354 |
| MICRO_AVG |    29.11% |  6.50% | 10.62% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    24.76% |  6.62% | 10.45% |     770 |
| MED       |   100.00% |  0.56% |  1.12% |     178 |
| MACRO_AVG |    62.38% |  3.59% |  5.78% |     948 |
| MICRO_AVG |    25.12% |  5.49% |  9.00% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 2/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 2/2
2375/2375 [==============================] - 102s 43ms/step - loss: 14.5948 - val_loss: 13.4612
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    43.99% | 32.42% | 37.33% |    2619 |
| MED       |    80.59% | 40.52% | 53.92% |     543 |
| MACRO_AVG |    62.29% | 36.47% | 45.62% |    3162 |
| MICRO_AVG |    48.52% | 33.81% | 39.85% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    35.89% | 27.78% | 31.32% |     270 |
| MED       |    82.05% | 38.10% | 52.03% |      84 |
| MACRO_AVG |    58.97% | 32.94% | 41.67% |     354 |
| MICRO_AVG |    43.15% | 30.23% | 35.55% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    36.16% | 26.62% | 30.67% |     770 |
| MED       |    76.62% | 33.15% | 46.27% |     178 |
| MACRO_AVG |    56.39% | 29.88% | 38.47% |     948 |
| MICRO_AVG |    40.99% | 27.85% | 33.17% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 3/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 3/3
2375/2375 [==============================] - 102s 43ms/step - loss: 14.4726 - val_loss: 13.3692
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    64.61% | 51.24% | 57.16% |    2619 |
| MED       |    78.36% | 52.67% | 63.00% |     543 |
| MACRO_AVG |    71.48% | 51.96% | 60.08% |    3162 |
| MICRO_AVG |    66.67% | 51.49% | 58.10% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    52.83% | 41.48% | 46.47% |     270 |
| MED       |    73.21% | 48.81% | 58.57% |      84 |
| MACRO_AVG |    63.02% | 45.15% | 52.52% |     354 |
| MICRO_AVG |    57.09% | 43.22% | 49.20% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    51.68% | 41.95% | 46.31% |     770 |
| MED       |    79.59% | 43.82% | 56.52% |     178 |
| MACRO_AVG |    65.64% | 42.88% | 51.41% |     948 |
| MICRO_AVG |    55.46% | 42.30% | 48.00% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 4/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 4/4
2375/2375 [==============================] - 102s 43ms/step - loss: 14.3982 - val_loss: 13.3440
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    68.25% | 66.55% | 67.39% |    2619 |
| MED       |    76.63% | 67.03% | 71.51% |     543 |
| MACRO_AVG |    72.44% | 66.79% | 69.45% |    3162 |
| MICRO_AVG |    69.56% | 66.64% | 68.07% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    48.11% | 51.85% | 49.91% |     270 |
| MED       |    78.46% | 60.71% | 68.46% |      84 |
| MACRO_AVG |    63.29% | 56.28% | 59.18% |     354 |
| MICRO_AVG |    53.65% | 53.95% | 53.80% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    52.43% | 53.25% | 52.84% |     770 |
| MED       |    77.86% | 57.30% | 66.02% |     178 |
| MACRO_AVG |    65.15% | 55.28% | 59.43% |     948 |
| MICRO_AVG |    56.08% | 54.01% | 55.02% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 5/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 5/5
2375/2375 [==============================] - 102s 43ms/step - loss: 14.3520 - val_loss: 13.3307
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    78.11% | 65.52% | 71.26% |    2619 |
| MED       |    86.79% | 59.30% | 70.46% |     543 |
| MACRO_AVG |    82.45% | 62.41% | 70.86% |    3162 |
| MICRO_AVG |    79.36% | 64.45% | 71.13% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.76% | 46.67% | 51.22% |     270 |
| MED       |    85.71% | 50.00% | 63.16% |      84 |
| MACRO_AVG |    71.24% | 48.33% | 57.19% |     354 |
| MICRO_AVG |    61.99% | 47.46% | 53.76% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    57.49% | 48.83% | 52.81% |     770 |
| MED       |    85.11% | 44.94% | 58.82% |     178 |
| MACRO_AVG |    71.30% | 46.89% | 55.82% |     948 |
| MICRO_AVG |    60.96% | 48.10% | 53.77% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 6/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 6/6
2375/2375 [==============================] - 102s 43ms/step - loss: 14.3218 - val_loss: 13.3674
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    64.12% | 59.91% | 61.94% |    2619 |
| MED       |    71.82% | 77.90% | 74.73% |     543 |
| MACRO_AVG |    67.97% | 68.90% | 68.34% |    3162 |
| MICRO_AVG |    65.61% | 63.00% | 64.28% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    50.97% | 48.89% | 49.91% |     270 |
| MED       |    60.22% | 66.67% | 63.28% |      84 |
| MACRO_AVG |    55.59% | 57.78% | 56.59% |     354 |
| MICRO_AVG |    53.41% | 53.11% | 53.26% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    49.58% | 45.45% | 47.43% |     770 |
| MED       |    69.28% | 64.61% | 66.86% |     178 |
| MACRO_AVG |    59.43% | 55.03% | 57.14% |     948 |
| MICRO_AVG |    53.33% | 49.05% | 51.10% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 7/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 7/7
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2945 - val_loss: 13.3430
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    86.67% | 73.73% | 79.68% |    2619 |
| MED       |    88.07% | 70.72% | 78.45% |     543 |
| MACRO_AVG |    87.37% | 72.22% | 79.06% |    3162 |
| MICRO_AVG |    86.90% | 73.21% | 79.47% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    60.27% | 50.00% | 54.66% |     270 |
| MED       |    84.13% | 63.10% | 72.11% |      84 |
| MACRO_AVG |    72.20% | 56.55% | 63.38% |     354 |
| MICRO_AVG |    65.51% | 53.11% | 58.66% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    60.00% | 49.48% | 54.23% |     770 |
| MED       |    82.30% | 52.25% | 63.92% |     178 |
| MACRO_AVG |    71.15% | 50.86% | 59.08% |     948 |
| MICRO_AVG |    63.37% | 50.00% | 55.90% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 8/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 8/8
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2680 - val_loss: 13.3445
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    70.65% | 80.60% | 75.30% |    2619 |
| MED       |    91.53% | 79.56% | 85.12% |     543 |
| MACRO_AVG |    81.09% | 80.08% | 80.21% |    3162 |
| MICRO_AVG |    73.50% | 80.42% | 76.80% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    50.70% | 66.67% | 57.60% |     270 |
| MED       |    79.73% | 70.24% | 74.68% |      84 |
| MACRO_AVG |    65.22% | 68.45% | 66.14% |     354 |
| MICRO_AVG |    55.71% | 67.51% | 61.05% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    47.30% | 57.92% | 52.07% |     770 |
| MED       |    83.48% | 53.93% | 65.53% |     178 |
| MACRO_AVG |    65.39% | 55.93% | 58.80% |     948 |
| MICRO_AVG |    51.23% | 57.17% | 54.04% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 9/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 9/9
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2547 - val_loss: 13.3495
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    81.74% | 85.45% | 83.55% |    2619 |
| MED       |    89.45% | 87.48% | 88.45% |     543 |
| MACRO_AVG |    85.60% | 86.46% | 86.00% |    3162 |
| MICRO_AVG |    82.99% | 85.80% | 84.37% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    50.63% | 59.26% | 54.61% |     270 |
| MED       |    74.39% | 72.62% | 73.49% |      84 |
| MACRO_AVG |    62.51% | 65.94% | 64.05% |     354 |
| MICRO_AVG |    55.53% | 62.43% | 58.78% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    51.91% | 60.13% | 55.72% |     770 |
| MED       |    78.77% | 64.61% | 70.99% |     178 |
| MACRO_AVG |    65.34% | 62.37% | 63.35% |     948 |
| MICRO_AVG |    55.68% | 60.97% | 58.21% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 10/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 10/10
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2403 - val_loss: 13.3852
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    89.60% | 80.95% | 85.06% |    2619 |
| MED       |    87.37% | 90.42% | 88.87% |     543 |
| MACRO_AVG |    88.48% | 85.69% | 86.96% |    3162 |
| MICRO_AVG |    89.17% | 82.57% | 85.75% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.38% | 50.74% | 53.41% |     270 |
| MED       |    70.11% | 72.62% | 71.35% |      84 |
| MACRO_AVG |    63.25% | 61.68% | 62.38% |     354 |
| MICRO_AVG |    60.00% | 55.93% | 57.89% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    59.52% | 51.56% | 55.25% |     770 |
| MED       |    72.09% | 69.66% | 70.86% |     178 |
| MACRO_AVG |    65.81% | 60.61% | 63.06% |     948 |
| MICRO_AVG |    62.10% | 54.96% | 58.31% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 11/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 11/11
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2258 - val_loss: 13.3610
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    91.38% | 86.25% | 88.74% |    2619 |
| MED       |    78.07% | 93.74% | 85.19% |     543 |
| MACRO_AVG |    84.73% | 90.00% | 86.97% |    3162 |
| MICRO_AVG |    88.60% | 87.54% | 88.07% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.85% | 56.67% | 57.74% |     270 |
| MED       |    63.21% | 79.76% | 70.53% |      84 |
| MACRO_AVG |    61.03% | 68.21% | 64.13% |     354 |
| MICRO_AVG |    60.11% | 62.15% | 61.11% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.86% | 53.51% | 56.05% |     770 |
| MED       |    64.56% | 74.72% | 69.27% |     178 |
| MACRO_AVG |    61.71% | 64.11% | 62.66% |     948 |
| MICRO_AVG |    60.15% | 57.49% | 58.79% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 12/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 12/12
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2217 - val_loss: 13.3333
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    90.81% | 91.68% | 91.24% |    2619 |
| MED       |    90.51% | 94.84% | 92.63% |     543 |
| MACRO_AVG |    90.66% | 93.26% | 91.93% |    3162 |
| MICRO_AVG |    90.76% | 92.22% | 91.48% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    52.37% | 61.48% | 56.56% |     270 |
| MED       |    71.28% | 79.76% | 75.28% |      84 |
| MACRO_AVG |    61.82% | 70.62% | 65.92% |     354 |
| MICRO_AVG |    56.69% | 65.82% | 60.92% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    52.70% | 58.31% | 55.36% |     770 |
| MED       |    77.78% | 70.79% | 74.12% |     178 |
| MACRO_AVG |    65.24% | 64.55% | 64.74% |     948 |
| MICRO_AVG |    56.71% | 60.65% | 58.61% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 13/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 13/13
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2116 - val_loss: 13.3723
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    88.30% | 90.49% | 89.38% |    2619 |
| MED       |    96.32% | 91.71% | 93.96% |     543 |
| MACRO_AVG |    92.31% | 91.10% | 91.67% |    3162 |
| MICRO_AVG |    89.60% | 90.70% | 90.15% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    50.00% | 59.63% | 54.39% |     270 |
| MED       |    81.08% | 71.43% | 75.95% |      84 |
| MACRO_AVG |    65.54% | 65.53% | 65.17% |     354 |
| MICRO_AVG |    55.81% | 62.43% | 58.93% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    50.40% | 56.88% | 53.45% |     770 |
| MED       |    80.58% | 62.92% | 70.66% |     178 |
| MACRO_AVG |    65.49% | 59.90% | 62.05% |     948 |
| MICRO_AVG |    54.56% | 58.02% | 56.24% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 14/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 14/14
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2118 - val_loss: 13.3477
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    95.21% | 91.87% | 93.51% |    2619 |
| MED       |    97.88% | 93.37% | 95.57% |     543 |
| MACRO_AVG |    96.54% | 92.62% | 94.54% |    3162 |
| MICRO_AVG |    95.67% | 92.13% | 93.86% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    61.65% | 60.74% | 61.19% |     270 |
| MED       |    81.82% | 75.00% | 78.26% |      84 |
| MACRO_AVG |    71.74% | 67.87% | 69.73% |     354 |
| MICRO_AVG |    66.18% | 64.12% | 65.14% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.97% | 56.36% | 57.64% |     770 |
| MED       |    86.57% | 65.17% | 74.36% |     178 |
| MACRO_AVG |    72.77% | 60.77% | 66.00% |     948 |
| MICRO_AVG |    63.22% | 58.02% | 60.51% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 15/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 15/15
2375/2375 [==============================] - 102s 43ms/step - loss: 14.2037 - val_loss: 13.4032
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    90.99% | 93.32% | 92.14% |    2619 |
| MED       |    96.79% | 94.29% | 95.52% |     543 |
| MACRO_AVG |    93.89% | 93.80% | 93.83% |    3162 |
| MICRO_AVG |    91.94% | 93.49% | 92.71% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    52.81% | 62.59% | 57.29% |     270 |
| MED       |    83.33% | 71.43% | 76.92% |      84 |
| MACRO_AVG |    68.07% | 67.01% | 67.11% |     354 |
| MICRO_AVG |    58.42% | 64.69% | 61.39% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    51.03% | 58.18% | 54.37% |     770 |
| MED       |    83.58% | 62.92% | 71.79% |     178 |
| MACRO_AVG |    67.30% | 60.55% | 63.08% |     948 |
| MICRO_AVG |    55.34% | 59.07% | 57.14% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 16/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 16/16
2375/2375 [==============================] - 102s 43ms/step - loss: 14.1992 - val_loss: 13.3842
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    93.21% | 95.46% | 94.32% |    2619 |
| MED       |    82.22% | 97.05% | 89.02% |     543 |
| MACRO_AVG |    87.71% | 96.25% | 91.67% |    3162 |
| MICRO_AVG |    91.09% | 95.73% | 93.35% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    54.55% | 64.44% | 59.08% |     270 |
| MED       |    63.06% | 83.33% | 71.79% |      84 |
| MACRO_AVG |    58.80% | 73.89% | 65.44% |     354 |
| MICRO_AVG |    56.74% | 68.93% | 62.24% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    52.90% | 61.69% | 56.95% |     770 |
| MED       |    64.71% | 74.16% | 69.11% |     178 |
| MACRO_AVG |    58.80% | 67.92% | 63.03% |     948 |
| MICRO_AVG |    55.08% | 64.03% | 59.22% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 17/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 17/17
2375/2375 [==============================] - 102s 43ms/step - loss: 14.1924 - val_loss: 13.3694
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    96.81% | 96.11% | 96.46% |    2619 |
| MED       |    98.30% | 95.76% | 97.01% |     543 |
| MACRO_AVG |    97.55% | 95.93% | 96.74% |    3162 |
| MICRO_AVG |    97.06% | 96.05% | 96.55% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.45% | 61.48% | 59.93% |     270 |
| MED       |    84.72% | 72.62% | 78.21% |      84 |
| MACRO_AVG |    71.59% | 67.05% | 69.07% |     354 |
| MICRO_AVG |    63.76% | 64.12% | 63.94% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    57.11% | 58.44% | 57.77% |     770 |
| MED       |    84.67% | 65.17% | 73.65% |     178 |
| MACRO_AVG |    70.89% | 61.81% | 65.71% |     948 |
| MICRO_AVG |    61.19% | 59.70% | 60.44% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 18/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 18/18
2375/2375 [==============================] - 102s 43ms/step - loss: 14.1880 - val_loss: 13.3917
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    96.69% | 94.69% | 95.68% |    2619 |
| MED       |    97.43% | 97.61% | 97.52% |     543 |
| MACRO_AVG |    97.06% | 96.15% | 96.60% |    3162 |
| MICRO_AVG |    96.82% | 95.19% | 96.00% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    61.72% | 58.52% | 60.08% |     270 |
| MED       |    81.18% | 82.14% | 81.66% |      84 |
| MACRO_AVG |    71.45% | 70.33% | 70.87% |     354 |
| MICRO_AVG |    66.57% | 64.12% | 65.32% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    58.16% | 54.16% | 56.09% |     770 |
| MED       |    71.84% | 70.22% | 71.02% |     178 |
| MACRO_AVG |    65.00% | 62.19% | 63.55% |     948 |
| MICRO_AVG |    60.83% | 57.17% | 58.95% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 19/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 19/19
2375/2375 [==============================] - 102s 43ms/step - loss: 14.1924 - val_loss: 13.4095
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    97.68% | 94.69% | 96.16% |    2619 |
| MED       |    98.31% | 96.69% | 97.49% |     543 |
| MACRO_AVG |    98.00% | 95.69% | 96.83% |    3162 |
| MICRO_AVG |    97.79% | 95.03% | 96.39% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    62.30% | 56.30% | 59.14% |     270 |
| MED       |    80.72% | 79.76% | 80.24% |      84 |
| MACRO_AVG |    71.51% | 68.03% | 69.69% |     354 |
| MICRO_AVG |    66.97% | 61.86% | 64.32% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    61.52% | 55.84% | 58.54% |     770 |
| MED       |    84.67% | 65.17% | 73.65% |     178 |
| MACRO_AVG |    73.09% | 60.51% | 66.10% |     948 |
| MICRO_AVG |    65.31% | 57.59% | 61.21% |     948 |
+-----------+-----------+--------+--------+---------+
Global epoch: 20/20
--------------------
Train on 2375 samples, validate on 264 samples
Epoch 20/20
2375/2375 [==============================] - 102s 43ms/step - loss: 14.1889 - val_loss: 13.4217
+---------------------------------------------------+
|                       TRAIN                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    97.50% | 96.87% | 97.18% |    2619 |
| MED       |    98.88% | 97.61% | 98.24% |     543 |
| MACRO_AVG |    98.19% | 97.24% | 97.71% |    3162 |
| MICRO_AVG |    97.74% | 97.00% | 97.37% |    3162 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                       VALID                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    55.56% | 57.41% | 56.47% |     270 |
| MED       |    83.75% | 79.76% | 81.71% |      84 |
| MACRO_AVG |    69.65% | 68.58% | 69.09% |     354 |
| MICRO_AVG |    61.84% | 62.71% | 62.27% |     354 |
+-----------+-----------+--------+--------+---------+
+---------------------------------------------------+
|                        TEST                       |
+-----------+-----------+--------+--------+---------+
| Label     | Precision | Recall |     F1 | Support |
+-----------+-----------+--------+--------+---------+
| DIS       |    56.71% | 58.18% | 57.44% |     770 |
| MED       |    83.45% | 67.98% | 74.92% |     178 |
| MACRO_AVG |    70.08% | 63.08% | 66.18% |     948 |
| MICRO_AVG |    60.86% | 60.02% | 60.44% |     948 |
+-----------+-----------+--------+--------+---------+
Saving model... Done (0.59 seconds).
Model was saved to /home/vk/pops/vk_thesis/pretrained_models/exp4/final
